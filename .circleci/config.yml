version: 2.1
jobs:
  build:
    docker:
      - image: docker:latest
    steps:
      - checkout
      - setup_remote_docker
      - run:
            name: Build and Push Images
            command: |
              echo "$DOCKERHUB_PASSWORD" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
              make run-dev
              docker tag everyshilling-backend:latest "$DOCKERHUB_USERNAME/everyshilling-backend:latest"
              docker push "$DOCKERHUB_USERNAME/everyshilling-backend:latest"
